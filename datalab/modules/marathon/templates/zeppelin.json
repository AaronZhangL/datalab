{
    "id": "{{zeppelin_id}}",
    "instances": 1,
    "cpus": {{ zeppelin_nb_cpus | default(1) }},
    "mem": {{ zeppelin_mem }},
    "requirePorts": false,
    "cmd": "mkdir -p {{ zeppelin_home_directory }}/mesos && cp {{ zeppelin_home_directory }}/conf/* {{ zeppelin_home_directory }}/mesos/ && cd {{ zeppelin_home_directory }} && sed \"s/{{zeppelin_service_server_port}}/$PORT/g\" < ./conf/zeppelin-env.sh > ./mesos/zeppelin-env.sh && sed \"s/{{zeppelin_service_server_port}}/$PORT/g\" < ./conf/zeppelin-site.xml > ./mesos/zeppelin-site.xml && chown -R {{zeppelin_user}} {{ zeppelin_home_directory }}/mesos && su - {{zeppelin_user}} -c \"{{ zeppelin_home_directory }}/bin/zeppelin.sh --config {{ zeppelin_home_directory }}/mesos\"",
    "constraints": [["hostname", "UNIQUE"], ["node_type", "CLUSTER", "{{zeppelin_node_type}}"]],
    "healthChecks": [
      {
        "protocol": "COMMAND",
        "command": { "value": "curl -f -X GET http://$HOST:$PORT" },
        "gracePeriodSeconds": 5,
        "intervalSeconds": 20,
        "maxConsecutiveFailures": 3
      }
    ]
}
