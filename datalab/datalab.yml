---

  - name: Install proxy
    hosts: proxy
    remote_user: $user
    sudo: yes
    roles:
      - {role: proxy}

  - name: Build and launch docker registry
    hosts: registry
    remote_user: $user
    sudo: yes
    roles:
      - {role: docker}
      - {role: docker.registry}

  - name: Install Docker
    hosts: docker
    remote_user: $user
    roles:
      - {role: docker}
      - {role: docker.registry.login}

  - name: Install and launch Zookeeper
    hosts: zookeeper
    remote_user: $user
    roles:
      - {role: zookeeper}

  - name: Install and launch Mesos
    hosts: mesos
    remote_user: $user
    roles:
      - {role: mesos}

  - name: Build datalab
    hosts: slave
    remote_user: $user
    roles:
      - {role: mesos-dns}
      - {role: es}
      - {role: kibana}
      - {role: kafka}
      - {role: flume}
      - {role: spark}
      - {role: zeppelin}

#  - name: Build datalab docker images
#    hosts: docker
#    remote_user: $user
#    roles:
#      - {role: docker.flume}

  - name: Launch datalab
    hosts: marathon
    remote_user: $user
    roles:
      - {role: marathon}
